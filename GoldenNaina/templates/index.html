{% extends 'partials/base.html' %}
{% load static %}

{% block content %}
{% if offer_themes %}
<section class="hero main-content" id="hero-container" style="background-image: url('{{ offer_themes.first.image.url }}')">
    <div class="hero-content">
        
        <a href="{% url 'men_products' %}" class="hero-link left">Him <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-bar-right" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M6 8a.5.5 0 0 0 .5.5h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L12.293 7.5H6.5A.5.5 0 0 0 6 8m-2.5 7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5"/>
          </svg></a>
        <a href="{% url 'women_products' %}" class="hero-link right">She <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-bar-right" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M6 8a.5.5 0 0 0 .5.5h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L12.293 7.5H6.5A.5.5 0 0 0 6 8m-2.5 7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 1 0v13a.5.5 0 0 1-.5.5"/>
          </svg></a>
    </div>
    <div class="carousel-indicators">
        {% for theme in offer_themes %}
        <span class="dot" onclick="changeHeroBackground({{ forloop.counter0 }})"></span>
        {% endfor %}
    </div>
</section>

{% endif %}

<div class="w-100">
  <img src="{% static 'images/coupons_corner.jpg' %}" alt="logo" class="img-fluid w-100" style="height: 200px;"></div>
<div class="coupons-corner">
  <div class="coupon">
      <span>FLAT AED 50 OFF*</span>
      <p>On All Products</p>
      <span>USE CODE: <b>GOLDEN50</b></span>
  </div>
  <div class="coupon">
      <span>FLAT AED 100 OFF*</span>
      <p>On All Products</p>
      <span>USE CODE: <b>GOLDEN100</b></span>
  </div>
</div>

<div class="crazy-deals">
  <h2>CRAZY DEALS</h2>
  <p>Big Savings All Day!</p>
</div>


<div class="w-100">
  <img src="{% static 'images/shop_by_category.jpg' %}" alt="logo" class="w-100" style="height: 200px;">
</div>
<div class="container">
  <div class="shop-by-category">
      <div class="row justify-content-center">
        {% for category in categories %}
          <div class="col-md-5 col-lg-4 category-card">
              <img src="{{ category.image.url }}" alt="{{ category.name }}">
              <div class="category-info">
                  <h3>{{ category.name }}</h3>
                  <p>UP TO {{ category.percentage }}% OFF</p>
                  <a href="{% url 'category_detail' category.pk %}">Shop Now</a>
              </div>
          </div>
          {% endfor %}
      </div>
  </div>
</div>

<h1 class="products-heading"><u style="text-decoration: underline dashed;">Trending</u>&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" fill="currentColor" class="bi bi-rocket-takeoff" viewBox="0 0 16 16">
    <path d="M9.752 6.193c.599.6 1.73.437 2.528-.362s.96-1.932.362-2.531c-.599-.6-1.73-.438-2.528.361-.798.8-.96 1.933-.362 2.532"/>
    <path d="M15.811 3.312c-.363 1.534-1.334 3.626-3.64 6.218l-.24 2.408a2.56 2.56 0 0 1-.732 1.526L8.817 15.85a.51.51 0 0 1-.867-.434l.27-1.899c.04-.28-.013-.593-.131-.956a9 9 0 0 0-.249-.657l-.082-.202c-.815-.197-1.578-.662-2.191-1.277-.614-.615-1.079-1.379-1.275-2.195l-.203-.083a10 10 0 0 0-.655-.248c-.363-.119-.675-.172-.955-.132l-1.896.27A.51.51 0 0 1 .15 7.17l2.382-2.386c.41-.41.947-.67 1.524-.734h.006l2.4-.238C9.005 1.55 11.087.582 12.623.208c.89-.217 1.59-.232 2.08-.188.244.023.435.06.57.093q.1.026.16.045c.184.06.279.13.351.295l.029.073a3.5 3.5 0 0 1 .157.721c.055.485.051 1.178-.159 2.065m-4.828 7.475.04-.04-.107 1.081a1.54 1.54 0 0 1-.44.913l-1.298 1.3.054-.38c.072-.506-.034-.993-.172-1.418a9 9 0 0 0-.164-.45c.738-.065 1.462-.38 2.087-1.006M5.205 5c-.625.626-.94 1.351-1.004 2.09a9 9 0 0 0-.45-.164c-.424-.138-.91-.244-1.416-.172l-.38.054 1.3-1.3c.245-.246.566-.401.91-.44l1.08-.107zm9.406-3.961c-.38-.034-.967-.027-1.746.163-1.558.38-3.917 1.496-6.937 4.521-.62.62-.799 1.34-.687 2.051.107.676.483 1.362 1.048 1.928.564.565 1.25.941 1.924 1.049.71.112 1.429-.067 2.048-.688 3.079-3.083 4.192-5.444 4.556-6.987.183-.771.18-1.345.138-1.713a3 3 0 0 0-.045-.283 3 3 0 0 0-.3-.041Z"/>
    <path d="M7.009 12.139a7.6 7.6 0 0 1-1.804-1.352A7.6 7.6 0 0 1 3.794 8.86c-1.102.992-1.965 5.054-1.839 5.18.125.126 3.936-.896 5.054-1.902Z"/>
  </svg></h1>

<div class="product-grid">
    {% for product in featured_products %}
    <div class="product-card">
        <div class="discount-label">{{ product.get_percentage }}% OFF</div>
        <a href="{% url 'product_detail' product.pk %}"><img src="{{ product.image.url }}" alt="Product Image"></a>
        <div class="product-info">
            <div class="product-title"><a href="{% url 'product_detail' product.pk %}">{{ product.title }}</a></div>
            
            <div>
                <span class="old-price">AED &nbsp;{{ product.price }}</span>
                <span class="price">AED  {{ product.discount_price }} </span>
                <span class="price">exclusively</span>

            </div>            
                <div class="rating">
                            <span>
                                {% for i in ''|ljust:product.rating %}
                                    â˜…
                                {% endfor %}
                            </span>            
            </div>
            {% if user.is_authenticated %}
                {% if product.pk in wishlist_products %}
                    <button class="add-to-wishlist" data-product-item="{{ product.pk }}" disabled>Added</button>
                {% else %}
                    <button class="add-to-wishlist" data-product-item="{{ product.pk }}">Add to Wishlist</button>
                {% endif %}
            {% else %}
                <a href="{% url 'Account' %}" class="add-to-wishlist">Login Required</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
<div class="view-all-container">
    <button class="products-all"><a href="{% url 'ProductList' %}" class="btn"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="32" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
        <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"/>
        <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"/>
      </svg>&nbsp;View All Products</a></button>
</div>

<section class="service">
    <div class="container">
      <ul class="service-list">
        <li class="service-item">
          <div class="service-item-icon">
            <img src="{% static 'images/service-icon-1.svg' %}" alt="Free Shipping Icon">
          </div>
          <div class="service-content">
            <p class="service-item-title">Free Shipping</p>
            <p class="service-item-text">On All Order Over AED 199</p>
          </div>
        </li>
        <li class="service-item">
          <div class="service-item-icon">
            <img src="{% static 'images/service-icon-2.svg' %}" alt="Easy Returns Icon">
          </div>
          <div class="service-content">
            <p class="service-item-title">Easy Returns</p>
            <p class="service-item-text">30 Day Returns Policy</p>
          </div>
        </li>
        <li class="service-item">
          <div class="service-item-icon">
            <img src="{% static 'images/service-icon-3.svg' %}" alt="Secure Payment Icon">
          </div>
          <div class="service-content">
            <p class="service-item-title"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="29" fill="currentColor" class="bi bi-shield-lock" viewBox="0 0 16 16">
                <path d="M5.338 1.59a61 61 0 0 0-2.837.856.48.48 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.7 10.7 0 0 0 2.287 2.233c.346.244.652.42.893.533q.18.085.293.118a1 1 0 0 0 .101.025 1 1 0 0 0 .1-.025q.114-.034.294-.118c.24-.113.547-.29.893-.533a10.7 10.7 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.8 11.8 0 0 1-2.517 2.453 7 7 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7 7 0 0 1-1.048-.625 11.8 11.8 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 63 63 0 0 1 5.072.56"/>
                <path d="M9.5 6.5a1.5 1.5 0 0 1-1 1.415l.385 1.99a.5.5 0 0 1-.491.595h-.788a.5.5 0 0 1-.49-.595l.384-1.99a1.5 1.5 0 1 1 2-1.415"/>
              </svg> Payment</p>
            <p class="service-item-text">100% Secure Guarantee</p>
          </div>
        </li>
      </ul>
    </div>
  </section>
  




{% endblock %}
{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        console.log("Document ready"); // Check if document ready is triggered
    
        // Attach click event to the button
        $(document).on('click', ".add-to-wishlist", function (){
            console.log("Button clicked"); // Check if the button click event is triggered
            var $button = $(this);
            var product_id = $button.data("product-item");
            console.log("Product ID:", product_id); 
            $.ajax({
                url: "add-to-wishlist",
                data: {
                    id: product_id,
                },
                dataType: "json",
                beforeSend: function() {
                    console.log("Adding to Wishlist...");
                },
                success: function(response) {
                    if (response.bool === true) {
                        console.log("Added to wishlist");
                        $button.text("Added");
                        $button.prop('disabled', true); // Optionally disable the button
                    }
                }
            });
        });
    });
    
      
document.addEventListener('DOMContentLoaded', () => {
  const heroContainer = document.getElementById('hero-container');
  const dots = document.querySelectorAll('.dot');
  const offerThemesImages = [
    {% for theme in offer_themes %}
    '{{ theme.image.url }}',
    {% endfor %}
  ];

  let currentIndex = 0;

  function changeHeroBackground(index) {
    heroContainer.style.backgroundImage = `url(${offerThemesImages[index]})`;
    currentIndex = index;

    dots.forEach((dot, idx) => {
      dot.classList.toggle('active', idx === index);
    });
  }

  function autoChangeHeroBackground() {
    currentIndex = (currentIndex + 1) % offerThemesImages.length;
    changeHeroBackground(currentIndex);
  }

  dots.forEach((dot, index) => {
    dot.addEventListener('click', () => changeHeroBackground(index));
  });

  setInterval(autoChangeHeroBackground, 5000); // Change every 5 seconds
});


</script>
{% endblock %}


